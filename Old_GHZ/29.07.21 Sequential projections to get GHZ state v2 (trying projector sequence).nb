(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     25679,        618]
NotebookOptionsPosition[     24081,        585]
NotebookOutlinePosition[     24424,        600]
CellTagsIndexPosition[     24381,        597]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListPlot", ",", 
    RowBox[{"BaseStyle", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
       RowBox[{"FontSize", "\[Rule]", "24"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yrotmatelem", "[", 
    RowBox[{"k_", ",", "kp_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "I"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "*", "k"}], "-", "Np"}], ")"}], "*", 
      RowBox[{"\[Phi]", "/", "2"}]}], "]"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k", "!"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Np", "-", "k"}], ")"}], "!"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"kp", "!"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Np", "-", "kp"}], ")"}], "!"}], ")"}]}], ")"}], "]"}], "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1.0"}], ")"}], "^", "n"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]", "/", "2"}], "]"}], "^", 
           RowBox[{"(", 
            RowBox[{"k", "-", "kp", "+", "Np", "-", 
             RowBox[{"2", "*", "n"}]}], ")"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "/", "2"}], "]"}], "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "n"}], "+", "kp", "-", "k"}], ")"}]}], ")"}]}],
         ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k", "-", "n"}], ")"}], "!"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Np", "-", "kp", "-", "n"}], ")"}], "!"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"n", "!"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"kp", "-", "k", "+", "n"}], ")"}], "!"}], ")"}]}], 
        ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"k", "-", "kp"}], ",", "0"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{"k", ",", 
          RowBox[{"Np", "-", "kp"}]}], "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"psi", "[", 
    RowBox[{"k1_", ",", "k2_", ",", "k3_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{
       RowBox[{"Sqrt", "[", "2", "]"}], "^", "Np"}]}], ")"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"Binomial", "[", 
       RowBox[{"Np", ",", "k1"}], "]"}], "*", 
      RowBox[{"Binomial", "[", 
       RowBox[{"Np", ",", "k2"}], "]"}], "*", 
      RowBox[{"Binomial", "[", 
       RowBox[{"Np", ",", "k3"}], "]"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.836518681203635*^9, 3.8365187056251907`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"7cfe1ac3-aeb9-4bad-aa50-29348c8746a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Np", "=", "3"}], ";", 
  RowBox[{"\[Theta]", "=", 
   RowBox[{"Pi", "/", "2"}]}], ";", 
  RowBox[{"\[Phi]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projmatz", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"k1", ",", "k1p"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"k2", ",", "k2p"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"k3", ",", "k3p"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k3", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1p", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2p", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k3p", ",", "0", ",", "Np"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Np", "+", "1"}], ")"}], "^", "3"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Np", "+", "1"}], ")"}], "^", "3"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psivec0", "=", 
   RowBox[{
    RowBox[{"ArrayReshape", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"psi", "[", 
         RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", "0", ",", "Np"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k2", ",", "0", ",", "Np"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k3", ",", "0", ",", "Np"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Np", "+", "1"}], ")"}], "^", "3"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Urot", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"yrotmatelem", "[", 
         RowBox[{"k1p", ",", "k1", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        "*", 
        RowBox[{"yrotmatelem", "[", 
         RowBox[{"k2p", ",", "k2", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
        "*", 
        RowBox[{"yrotmatelem", "[", 
         RowBox[{"k3p", ",", "k3", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k3", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1p", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2p", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k3p", ",", "0", ",", "Np"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Np", "+", "1"}], ")"}], "^", "3"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Np", "+", "1"}], ")"}], "^", "3"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ghzstate", "=", 
   RowBox[{
    RowBox[{"ArrayReshape", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Binomial", "[", 
           RowBox[{"Np", ",", "k1"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", "0", ",", "Np"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k2", ",", "0", ",", "Np"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k3", ",", "0", ",", "Np"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Np", "+", "1"}], ")"}], "^", "3"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ghzstate", "=", 
   RowBox[{"N", "[", 
    RowBox[{"Normalize", "[", "ghzstate", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8365187362955503`*^9, 3.836518749087101*^9}, {
   3.836518781315363*^9, 3.836518950505986*^9}, {3.836519308255763*^9, 
   3.8365193229828453`*^9}, 3.8365196414067965`*^9, 3.836519726670556*^9, 
   3.8365198828638763`*^9, {3.8365201246464214`*^9, 3.8365201247605224`*^9}, 
   3.8365201756629395`*^9, 3.8365202103963327`*^9, 3.836520313396208*^9, {
   3.8365224780948176`*^9, 3.836522482153569*^9}, {3.83652257715526*^9, 
   3.836522600935607*^9}},
 CellLabel->
  "In[422]:=",ExpressionUUID->"23d090c7-dcc8-4c94-8263-0e89531f38d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"targetlist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"l", "=", "0"}], ",", 
    RowBox[{"l", "\[LessEqual]", "Np"}], ",", 
    RowBox[{"l", "=", 
     RowBox[{"l", "+", "1"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"m", "=", "0"}], ",", 
       RowBox[{"m", "<=", 
        RowBox[{"Np", "-", "l"}]}], ",", 
       RowBox[{"m", "=", 
        RowBox[{"m", "+", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"n", "=", "0"}], ",", 
          RowBox[{"n", "\[LessEqual]", 
           RowBox[{"Np", "-", "l", "-", "m"}]}], ",", 
          RowBox[{"n", "=", 
           RowBox[{"n", "+", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"p", "=", 
             RowBox[{"Np", "-", "l", "-", "m", "-", "n"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"s1", "=", 
             RowBox[{"l", "+", "m", "-", "n", "-", "p"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"s2", "=", 
             RowBox[{"l", "-", "m", "+", "n", "-", "p"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"s3", "=", 
             RowBox[{"l", "-", "m", "-", "n", "+", "p"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"k1", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"s1", "+", "Np"}], ")"}], "/", "2"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"k2", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"s2", "+", "Np"}], ")"}], "/", "2"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"k3", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"s3", "+", "Np"}], ")"}], "/", "2"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"k1", "=", 
            RowBox[{"l", "+", "m"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"k2", "=", 
            RowBox[{"l", "+", "n"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"k3", "=", 
            RowBox[{"Np", "-", "m", "-", "n"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"targetlist", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"targetlist", ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}]}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projmatx0", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"k1", ",", "k1p"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"k2", ",", "k2p"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"k3", ",", "k3p"}], "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"targetlist", ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}]}], "]"}], ",", "1", 
          ",", "0"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k3", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1p", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2p", ",", "0", ",", "Np"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k3p", ",", "0", ",", "Np"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Np", "+", "1"}], ")"}], "^", "3"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Np", "+", "1"}], ")"}], "^", "3"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projmatx", "=", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", "Urot", "]"}], ".", "projmatx0", ".", 
    "Urot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.836519006104288*^9, 3.836519068591971*^9}, {
  3.8365191296471186`*^9, 3.836519219595208*^9}, {3.8365192521247044`*^9, 
  3.8365192832423544`*^9}, {3.836519991368577*^9, 3.836520039984215*^9}, {
  3.8365212357733526`*^9, 3.8365212822086816`*^9}, {3.8365213429541116`*^9, 
  3.8365213434986534`*^9}, {3.83652145036016*^9, 3.8365214815086584`*^9}, {
  3.8365221993099465`*^9, 3.8365222017734575`*^9}},
 CellLabel->
  "In[428]:=",ExpressionUUID->"2d607cbd-1978-4b1b-abdb-d41a0167fd00"],

Cell[CellGroupData[{

Cell["Apply projection sequence and measure fidelity", "Subsubsection",
 CellChangeTimes->{{3.8365203566230464`*^9, 
  3.836520367375631*^9}},ExpressionUUID->"e16bb634-667f-4ef6-b218-\
62814b501ebb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"psifinal", "=", 
   RowBox[{
    RowBox[{"MatrixPower", "[", 
     RowBox[{
      RowBox[{"projmatz", ".", "projmatx"}], ",", "5"}], "]"}], ".", 
    "projmatz", ".", "psivec0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"psifinal", "=", 
  RowBox[{
  "Normalize", "[", "psifinal", 
   "]"}]}], "\[IndentingNewLine]", "ghzstate", "\[IndentingNewLine]", 
 RowBox[{"psifinal", ".", "ghzstate"}]}], "Input",
 CellChangeTimes->{{3.8365193350451875`*^9, 3.8365193755395746`*^9}, {
   3.836519526131734*^9, 3.836519555492117*^9}, {3.8365195916066756`*^9, 
   3.8365196233472652`*^9}, {3.8365197394021034`*^9, 
   3.8365197813974824`*^9}, {3.8365200640808125`*^9, 
   3.8365200883346663`*^9}, {3.8365201374477787`*^9, 
   3.8365202291348114`*^9}, {3.8365203255659404`*^9, 
   3.8365203386054225`*^9}, {3.836521317470888*^9, 3.8365213215491047`*^9}, 
   3.8365214862282763`*^9},
 CellLabel->
  "In[432]:=",ExpressionUUID->"113483a7-a7ff-4bbc-9a83-798ab29aa37a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.6057251314921385`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.36482470458952126`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.36482470458952126`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.6057251314921385`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8365192961752434`*^9, {3.836519326489812*^9, 3.8365193758407717`*^9}, {
   3.8365195344663186`*^9, 3.8365195562348304`*^9}, {3.8365195918090115`*^9, 
   3.8365196473239517`*^9}, {3.8365197326123905`*^9, 3.836519781640235*^9}, 
   3.8365198880368233`*^9, {3.836520060422888*^9, 3.836520088594016*^9}, {
   3.836520132460457*^9, 3.836520229526764*^9}, {3.8365203202951975`*^9, 
   3.836520338805887*^9}, {3.8365212954234843`*^9, 3.836521346527219*^9}, {
   3.836521466845702*^9, 3.8365214863823023`*^9}, 3.836521687056888*^9, 
   3.8365222052086287`*^9, 3.836522606085702*^9},
 CellLabel->
  "Out[433]=",ExpressionUUID->"2320bc2d-e1ee-46c9-9a6d-fc377a0404f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.6123724356957945`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.35355339059327373`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.35355339059327373`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.6123724356957945`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8365192961752434`*^9, {3.836519326489812*^9, 3.8365193758407717`*^9}, {
   3.8365195344663186`*^9, 3.8365195562348304`*^9}, {3.8365195918090115`*^9, 
   3.8365196473239517`*^9}, {3.8365197326123905`*^9, 3.836519781640235*^9}, 
   3.8365198880368233`*^9, {3.836520060422888*^9, 3.836520088594016*^9}, {
   3.836520132460457*^9, 3.836520229526764*^9}, {3.8365203202951975`*^9, 
   3.836520338805887*^9}, {3.8365212954234843`*^9, 3.836521346527219*^9}, {
   3.836521466845702*^9, 3.8365214863823023`*^9}, 3.836521687056888*^9, 
   3.8365222052086287`*^9, 3.8365226060946765`*^9},
 CellLabel->
  "Out[434]=",ExpressionUUID->"dc1ee6ad-08be-4852-96eb-9182a7cdc12a"],

Cell[BoxData["0.9998287708276219`"], "Output",
 CellChangeTimes->{
  3.8365192961752434`*^9, {3.836519326489812*^9, 3.8365193758407717`*^9}, {
   3.8365195344663186`*^9, 3.8365195562348304`*^9}, {3.8365195918090115`*^9, 
   3.8365196473239517`*^9}, {3.8365197326123905`*^9, 3.836519781640235*^9}, 
   3.8365198880368233`*^9, {3.836520060422888*^9, 3.836520088594016*^9}, {
   3.836520132460457*^9, 3.836520229526764*^9}, {3.8365203202951975`*^9, 
   3.836520338805887*^9}, {3.8365212954234843`*^9, 3.836521346527219*^9}, {
   3.836521466845702*^9, 3.8365214863823023`*^9}, 3.836521687056888*^9, 
   3.8365222052086287`*^9, 3.8365226061016583`*^9},
 CellLabel->
  "Out[435]=",ExpressionUUID->"c53e2f51-db92-43b6-a1fa-978b7c85b398"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["fidelity after first z projection", "Subsubsection",
 CellChangeTimes->{{3.8365203722646976`*^9, 
  3.836520379777671*^9}},ExpressionUUID->"6f33f691-ad2b-4a54-9528-\
b835f5e1e14c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"psifinal", "=", 
   RowBox[{"projmatz", ".", "psivec0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"psifinal", "=", 
  RowBox[{"N", "[", 
   RowBox[{"Normalize", "[", "psifinal", "]"}], 
   "]"}]}], "\[IndentingNewLine]", "ghzstate", "\[IndentingNewLine]", 
 RowBox[{"psifinal", ".", "ghzstate"}]}], "Input",
 CellChangeTimes->{{3.8365202434518814`*^9, 3.8365202816691103`*^9}},
 CellLabel->
  "In[382]:=",ExpressionUUID->"cc9564dd-378b-4dd3-8d1f-aacf0ab8bc98"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.053760333057047034`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.4300826644563763`", ",", "0.`", ",", "0.`",
    ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.7901123063510648`",
    ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.4300826644563763`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`",
    ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.053760333057047034`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8365202485601854`*^9, 3.8365202820012207`*^9}, 
   3.836520340573498*^9, 3.836521313799633*^9, 3.836521684253297*^9},
 CellLabel->
  "Out[383]=",ExpressionUUID->"3bacb9dc-80ec-4ba7-bc53-7a25054d5779"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.6123724356957945`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.30618621784789724`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.25`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.30618621784789724`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.6123724356957945`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8365202485601854`*^9, 3.8365202820012207`*^9}, 
   3.836520340573498*^9, 3.836521313799633*^9, 3.8365216842652674`*^9},
 CellLabel->
  "Out[384]=",ExpressionUUID->"6990e08d-cad6-4ec9-b9cf-569abe6763cb"],

Cell[BoxData["0.5267415375673765`"], "Output",
 CellChangeTimes->{{3.8365202485601854`*^9, 3.8365202820012207`*^9}, 
   3.836520340573498*^9, 3.836521313799633*^9, 3.836521684271286*^9},
 CellLabel->
  "Out[385]=",ExpressionUUID->"f6bf421f-5319-4ff2-b455-317ba3258804"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{759, 697},
WindowMargins->{{280, Automatic}, {Automatic, 32}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3493, 106, 162, "Input",ExpressionUUID->"7cfe1ac3-aeb9-4bad-aa50-29348c8746a2"],
Cell[4054, 128, 5033, 137, 333, "Input",ExpressionUUID->"23d090c7-dcc8-4c94-8263-0e89531f38d8"],
Cell[9090, 267, 4835, 124, 466, "Input",ExpressionUUID->"2d607cbd-1978-4b1b-abdb-d41a0167fd00"],
Cell[CellGroupData[{
Cell[13950, 395, 199, 3, 44, "Subsubsection",ExpressionUUID->"e16bb634-667f-4ef6-b218-62814b501ebb"],
Cell[CellGroupData[{
Cell[14174, 402, 990, 22, 86, "Input",ExpressionUUID->"113483a7-a7ff-4bbc-9a83-798ab29aa37a"],
Cell[15167, 426, 1616, 25, 90, "Output",ExpressionUUID->"2320bc2d-e1ee-46c9-9a6d-fc377a0404f6"],
Cell[16786, 453, 1618, 25, 90, "Output",ExpressionUUID->"dc1ee6ad-08be-4852-96eb-9182a7cdc12a"],
Cell[18407, 480, 730, 11, 32, "Output",ExpressionUUID->"c53e2f51-db92-43b6-a1fa-978b7c85b398"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19186, 497, 186, 3, 44, "Subsubsection",ExpressionUUID->"6f33f691-ad2b-4a54-9528-b835f5e1e14c"],
Cell[CellGroupData[{
Cell[19397, 504, 498, 11, 86, "Input",ExpressionUUID->"cc9564dd-378b-4dd3-8d1f-aacf0ab8bc98"],
Cell[19898, 517, 1947, 28, 128, "Output",ExpressionUUID->"3bacb9dc-80ec-4ba7-bc53-7a25054d5779"],
Cell[21848, 547, 1933, 28, 128, "Output",ExpressionUUID->"6990e08d-cad6-4ec9-b9cf-569abe6763cb"],
Cell[23784, 577, 269, 4, 32, "Output",ExpressionUUID->"f6bf421f-5319-4ff2-b455-317ba3258804"]
}, Open  ]]
}, Open  ]]
}
]
*)

